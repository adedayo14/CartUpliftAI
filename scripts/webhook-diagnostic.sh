#!/bin/bash

echo ""
echo "üîç WEBHOOK DIAGNOSTIC CHECKLIST"
echo "================================"
echo ""
echo "1Ô∏è‚É£  CHECK SHOPIFY WEBHOOK REGISTRATION"
echo "   ‚Üí Go to: https://admin.shopify.com/store/sectionappblocks/settings/notifications"
echo "   ‚Üí Look for: 'Webhooks' section"
echo "   ‚Üí Verify: 'Order creation' webhook exists"
echo "   ‚Üí Should point to: https://cartuplift.vercel.app/webhooks/orders/create"
echo ""
echo "2Ô∏è‚É£  CHECK VERCEL FUNCTION LOGS"
echo "   ‚Üí Go to: https://vercel.com/adedayo14/cartuplift/logs"
echo "   ‚Üí Filter by: '/webhooks/orders/create'"
echo "   ‚Üí Look for: Recent webhook calls with 'üéØ Order webhook START'"
echo ""
echo "3Ô∏è‚É£  MANUAL WEBHOOK TEST"
echo "   ‚Üí In Shopify webhooks page, find 'Order creation' webhook"
echo "   ‚Üí Click 'Send test notification'"
echo "   ‚Üí Check Vercel logs for response"
echo ""
echo "4Ô∏è‚É£  CHECK PRODUCT ID FORMAT"
echo "   Your latest order had these products:"
echo "   - Hi top calf leather"
echo "   - The Letterman"
echo ""
echo "   ‚Üí Go to Shopify Products page"
echo "   ‚Üí Click on 'Hi top calf leather'"
echo "   ‚Üí Check URL for product ID (e.g., /products/1234567890)"
echo "   ‚Üí Compare with tracking event product IDs"
echo ""
echo "5Ô∏è‚É£  QUICK FIX: Re-deploy webhook"
echo "   Run: cd /Users/dayo/CartUpliftAI/CartUpliftAI && shopify app deploy"
echo "   This will re-register all webhooks"
echo ""
echo "üìã COMMON ISSUES:"
echo "   ‚ùå Webhook not registered ‚Üí Run 'shopify app deploy'"
echo "   ‚ùå Product ID mismatch ‚Üí Check if IDs include 'gid://shopify/Product/' prefix"
echo "   ‚ùå Webhook timing out ‚Üí Check Vercel function logs for errors"
echo "   ‚ùå Database write failing ‚Üí Check Neon Postgres connection"
echo ""
